<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Engine</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/p5.min.js"></script>
    <script id="p5js" src="sketches\Phys_Engine\ball2.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    

</head>


<body id="para">
    <h1 id="main">A Brief Explanation of Physics Engines</h1>
    
<div id="paragraph">Physics Engines are the cornerstone of both 2D and 3D games which involve forces and 
movements. In many games, physics can be complex, taking into account many different 
factors (wind, gravity, gliding etc). Letâ€™s look at creating a simple Physics Engine and explore
some of the simple math that can have a powerful effect in a game to make it engaging and realistic.
</div>
<div id="space"></div>
<div id="paragraph">The first step is to outline what we want to accomplish. As an example, lets
    make a simple bouncing ball. Our scene involves two objects: a ball and the ground. We want the ball to bounce off the ground. I have made a simple sketch in p5js for us to experiment with.
     Lets draw our ball and the ground:
</div>
<div id="space"></div> 

<div id="p5sketch" class="p5form"></div>

<div id="space"></div> 
<div id="paragraph"> 
    Now we have our scene set up. To make the ball bounce we have to consider two things: <b>Gravity</b> and <strong>Collision</strong>. We need
    gravity to allow our ball to fall towards the ground and we need collisions to make sure the ball bounces off the ground and doesn't fall offscreen. We can tackle these one at a time.
    <div id="space"></div> Starting with gravity, the standard way to deal with forces and acceleration is to store each of those values and augment them each frame. We will have an acceleration value, a speed value and a position value, and they
    will feed into each other to give a smooth realistic movement.
</div>
<div id="space"></div> 
<div id="paragraph"> Below is the code that we will use to create this effect. Six variables: two for position, two for speed, and two for acceleration. Each one represents position, speed
    or acceleration in the two different axes (x and y). This allows us to seperate any forces into those two directions. For now, we can ignore the x axis, as we only want the ball to bounce up and down.
    Our update function runs every frame, and thats where the real magic happens. We want the acceleration to affect the speed of the ball and we want the speed to update the position of the ball. So we add 
    our acceleration to the speed and add the speed to the position to move the ball.
</div>
<div id="space"></div> 
<pre><code id="cod" class="language-javascript">
    var xPos = sketch.width/2; //Inital location of the ball
    var yPos = sketch.height/4;
    var xSpeed = 0; //Inital speed of 0
    var ySpeed = 0;
    var xAcc = 0;
    var yAcc = 1; //Downward accleration due to gravity
    const max_speed = 20;

    function update() {

        // Speed is increased by acceleration
        xSpeed += xAcc;
        ySpeed += yAcc;

        // Position is moved based on speed
        xPos += xSpeed;
        yPos += ySpeed;

        // To make sure our engine doesn't go too crazy we limit the speed the ball can fall at
        // This is analagous to terminal velocity (a max speed that an object can fall at due to wind resistance)
        // despite us ignoring wind resistance
        if (xSpeed > max_speed) {
            xSpeed = 20;
        }
        if (ySpeed > max_speed) {
            ySpeed = 20;
        }
    }
    </code></pre>
    <div id="space"></div> 

<div id="p5sketch2" class="p5form">

</div>
<div id="wrapper"><button id="butt" onclick="myp5_2.reset()" class="reset" role="button">Reset</button></div>
<div id="space"></div> 
<div id="paragraph"> The ball may have already dropped below the screen so hit the reset button to watch it go again. We have created gravity! Downward acceleration is set to 1, rather than the more realistic 9.8 meters per second squared because our update function
    runs every frame rather than every second. Ideally we would want the acceleration applied every second rather than every frame (average computers run 24 frames a second) for ultra realism
    but having something that looks and feels right can sometimes be more important than having something ultra realistic.
</div>
<div id="space"></div> 
<div id="paragraph">
Our next goal is to add collisions, so the ball does not go through the ground. Collisions are, in game terms, looking for and handling moments of overlap between objects that we
 want to interact with each other. 
In our case we want the ball to bounce off the ground. First we must check if the edge of the ball is overlapping the edge of the ground. Then we must set the speed of the ball to be 
pointing in the other direction (Following the behaviour of Newton's Third law: Equal and opposite reaction). Before we let the forces go to work, we must reset the ball's position to be 
just above the ground to not overlap the ground to avoid any untoward bugs that may arise.
</div>
<div id="space"></div> 
<pre><code id="cod" class="language-javascript">
    var rectHeight; // The height of the rectangle (since our ground starts from the bottom of the screen we don't have to worry about its location)
    var radius; // The radius of the ball

    function checkCollision() {
        // We check if our y position is one radius away from the rectHeight
        // Since the edge of our ball is at a distance of radius away from the center (yPos) 
        // we have to subtract that from the height of the rectangle to see if we overlap
        if (yPos > rectHeight - radius) {

            // We set the ySpeed to point in the other direction
            ySpeed = -ySpeed;

            // We reset the position of the ball to be just touching the ground's surface
            yPos = rectHeight - radius
        }
    }
    </code></pre>
<div id="space"></div>
<div id="p5sketch3" class="p5form"></div>
<div id="space"></div>
<div id="paragraph">Voila! We have a bouncing ball. To recap, we added gravity by keeping track of our speed and position, and updated them to reflect the effect
    of a constant force being applied. Then we handled collisions by checking for overlaps and implementing the behaviour we want. </div>
<div id="space"></div>
<div id="paragraph"> This is 
    a simple demonstration, and if you are so minded, playing around with p5.js, or other creative coding tools you can learn more. Hopefully you gained a little insight into some of the complex
    things that go on behind the scenes of physics engines. This is on the simpler side, but I hope this demonstration can help you appreciate the work and thought
that goes into making the video games you love. </div>
<div id="space"></div>
<div><a href="https://github.com/StrawberryMilsc/3d-website-portfolio/blob/gh-pages/sketches/Phys_Engine/ball2.js">Code</a></div>

</body>

</html>